// Konfiguration der Ausgänge
//        (Name,             Port, Bit,  Alias)
OUT_ALIAS (led1,             A,    7,    led_eingekuppelt_links)
OUT_ALIAS (led2,             A,    6,    led_eingekuppelt_rechts)
OUT_ALIAS (led3,             A,    5,    led_handbremse)
OUT_ALIAS (led4,             A,    4,    led_kappvorrichtung)
OUT_ALIAS (led5,             A,    3,    led_temperatur)
OUT_ALIAS (led6,             A,    2,    led_power)
OUT       (led7,             A,    1)
OUT       (led8,             A,    0)
OUT       (buzzer,           F,    2)
OUT       (latch_disable,    B,    6)
OUT       (zuendung_an,      C,    0)
OUT       (zuendungsbruecke, C,    1)
OUT       (system1,          C,    2)
OUT       (system2,          C,    3)
OUT       (system3,          C,    4)
OUT_ALIAS (system4,          C,    5,    gassperre)
OUT_ALIAS (system5,          C,    6,    trommelbremse)
OUT_ALIAS (system6,          C,    7,    auszugsbremse)

// Konfiguration der Eingänge
//       (Name,              Port, Bit,  Alias)
IN_ALIAS (schalter1,         E,    2,    schalter_einkuppeln_links)
IN_ALIAS (schalter2,         E,    3,    schalter_einkuppeln_rechts)
IN_ALIAS (schalter3,         E,    4,    schalter_bremse_auf)
IN       (schalter4,         E,    5)
IN_ALIAS (schalter5,         E,    6,    schalter_auskuppeln)
IN       (schalter6,         B,    5)
IN_ALIAS (system1,           D,    7,    bremse_getreten)
IN_ALIAS (system2,           D,    6,    falscher_gang)
IN_ALIAS (system3,           D,    5,    drehzahl_links)
IN_ALIAS (system4,           D,    4,    drehzahl_rechts)
IN_ALIAS (system5,           D,    3,    falsche_motor_temp)
IN_ALIAS (system6,           D,    2,    falsche_wandler_temp)
IN_ALIAS (system7,           D,    1,    kappvorrichtung_gespannt)
IN_ALIAS (system8,           D,    0,    handbremse_angezogen)
IN       (system9,           B,    7)

// Zustände des Automaten
//    (Zustandsname,        Eingangsaktion)
STATE (start,               keine_aktion)
STATE (bereit,              keine_aktion)
STATE (links_eingekuppelt,  links_einkuppeln)
STATE (rechts_eingekuppelt, rechts_einkuppeln)
STATE (ende,                keine_aktion)

// Ereignisse, die Zustandsübergänge auslösen
//    (Ereignisname,               Boolescher Ausdruck)
EVENT (alles_ok,                   in.kappvorrichtung_gespannt &&
                                   in.bremse_getreten &&
                                   in.handbremse_angezogen &&
          			   !in.falscher_gang &&
                                   !in.falsche_motor_temp &&
                                   !in.falsche_wandler_temp)
EVENT (nicht_alles_ok,             !event_alles_ok())
EVENT (schalter_einkuppeln_links,  in.schalter_einkuppeln_links)
EVENT (schalter_einkuppeln_rechts, in.schalter_einkuppeln_rechts)

// Aktionen beim Betreten eines Zustands
//     (Aktionsname,                Code-Block)
ACTION (keine_aktion,               {})
ACTION (aktualisiere_kontroll_leds, {})
ACTION (links_einkuppeln,           {})
ACTION (rechts_einkuppeln,          {})

// Übergänge zwischen Zuständen
//         (Anfangszustand, Ereignis,                   Endzustand)
TRANSITION (start,          alles_ok,                   bereit)
TRANSITION (start,          nicht_alles_ok,             start)
TRANSITION (bereit,         nicht_alles_ok,             start)
TRANSITION (bereit,         schalter_einkuppeln_links,  links_eingekuppelt)
TRANSITION (bereit,         schalter_einkuppeln_rechts, rechts_eingekuppelt)
TRANSITION (start,          schalter_einkuppeln_links,  start)
TRANSITION (start,          schalter_einkuppeln_rechts, start)
